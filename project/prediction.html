<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Disease Prediction Result</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  :root {
    --primary-color: #047857;
    --primary-dark: #065f46;
    --background-color: #e0f2f1;
    --card-bg: #ffffff;
    --text-dark: #064e3b;
    --text-muted: #4b5563;
    --shadow: rgba(4, 120, 87, 0.3);
    --border-radius: 14px;
    --transition: 0.5s ease;
  }

  body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background-color: var(--background-color);
    color: var(--text-dark);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 30px;
    overflow-x: hidden;
    opacity: 0;
    animation: fadeInPage 0.7s forwards;
  }

  @keyframes fadeInPage {
    to {
      opacity: 1;
    }
  }

  .container {
    background: var(--card-bg);
    max-width: 600px;
    width: 100%;
    border-radius: var(--border-radius);
    box-shadow: 0 14px 40px var(--shadow);
    padding: 40px 50px;
    box-sizing: border-box;
    text-align: center;
  }

  h1 {
    font-weight: 700;
    font-size: 2.6rem;
    color: var(--primary-color);
    margin-bottom: 12px;
  }

  .icon-medical {
    font-size: 3.5rem;
    margin-bottom: 18px;
    animation: pulse 3s infinite;
    color: var(--primary-color);
  }

  @keyframes pulse {
    0%, 100% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.2);
      opacity: 0.6;
    }
  }

  .patient-info {
    font-weight: 500;
    font-size: 1.15rem;
    color: var(--text-muted);
    margin-bottom: 30px;
    white-space: pre-line;
    line-height: 1.5;
  }

  .prediction {
    background-color: #d1fae5;
    border-radius: var(--border-radius);
    padding: 20px 30px;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--primary-dark);
    box-shadow: 0 6px 20px rgba(4, 120, 87, 0.4);
    min-height: 140px;
  }

  button {
    margin-top: 40px;
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 14px 40px;
    font-size: 1.2rem;
    font-weight: 700;
    border-radius: var(--border-radius);
    cursor: pointer;
    box-shadow: 0 8px 26px var(--shadow);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }

  button:hover {
    background-color: var(--primary-dark);
    box-shadow: 0 10px 30px var(--shadow);
  }

  /* Accessible focus */
  button:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 2px;
  }
</style>
</head>
<body>

  <main class="container" role="main" aria-labelledby="result-title">
    <div class="icon-medical" aria-hidden="true">⚕️</div>
    <h1 id="result-title">Disease Prediction Result</h1>
    <pre class="patient-info" id="patientInfo" tabindex="0" aria-live="polite"></pre>
    <div class="prediction" id="predictionText" aria-live="polite"></div>
    <button id="goBackBtn" aria-label="Go back and submit another prediction">Predict Another</button>
  </main>

  <script>
    const urlParams = new URLSearchParams(window.location.search);

    // Extract patient data from URL params
    const patientData = {
      fullName: urlParams.get("fullName"),
      age: urlParams.get("age"),
      gender: urlParams.get("gender"),
      date: urlParams.get("date"),
      symptoms: urlParams.get("symptoms"),
      medicalHistory: urlParams.get("medicalHistory") || "None",
      allergies: urlParams.get("allergies") || "None",
    };

    const patientInfoEl = document.getElementById('patientInfo');
    const predictionTextEl = document.getElementById('predictionText');
    const goBackBtn = document.getElementById('goBackBtn');

    // Show patient info
    patientInfoEl.textContent = `
Name: ${patientData.fullName}
Age: ${patientData.age}
Gender: ${patientData.gender}
Date: ${patientData.date}

Symptoms: ${patientData.symptoms}
Medical History: ${patientData.medicalHistory}
Allergies: ${patientData.allergies}
    `;

    // Simulate AI prediction with delay + animations
    function simulatePrediction(symptoms) {
      return new Promise(resolve => {
        setTimeout(() => {
          const s = symptoms.toLowerCase();

          let diagnosis = "Unable to confidently predict disease. Please provide more detailed symptoms.";

          if (s.includes("fever") && s.includes("cough")) {
            diagnosis = "Flu or COVID-19 suspected. Immediate COVID-19 testing and medical consultation advised.";
          } else if (s.includes("headache") && s.includes("nausea")) {
            diagnosis = "Possible migraine. Neurological evaluation recommended.";
          } else if (s.includes("chest pain") || s.includes("shortness of breath")) {
            diagnosis = "Potential cardiac condition. Urgent cardiology consultation necessary.";
          } else if (s.includes("fatigue") && s.includes("weight loss")) {
            diagnosis = "Likely Diabetes or Thyroid disorder. Blood tests and specialist consultation required.";
          }

          resolve(diagnosis);
        }, 2200);
      });
    }

    // Show loader then prediction
    async function displayPrediction() {
      predictionTextEl.textContent = 'Predicting disease';
      let dots = 0;
      const interval = setInterval(() => {
        dots = (dots + 1) % 4;
        predictionTextEl.textContent = 'Predicting disease' + '.'.repeat(dots);
      }, 400);

      const prediction = await simulatePrediction(patientData.symptoms);

      clearInterval(interval);
      predictionTextEl.textContent = prediction;
    }

    goBackBtn.addEventListener("click", () => {
      window.location.href = "demo1.html";
    });

    // Start prediction on page load
    displayPrediction();

  </script>
</body>
</html>
